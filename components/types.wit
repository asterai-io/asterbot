package asterbot:types@1.0.0;

/// Shared types used across asterbot components.
interface types {
  /// Describes a parameter of a tool function.
  record tool-param {
    /// Parameter name.
    name: string,
    /// Type name (e.g. "string", "u32", "list<string>").
    type-name: string,
  }

  /// Describes a callable tool function.
  record tool-info {
    /// Component name (e.g. "asterai:http-client").
    component-name: string,
    /// Function name including interface
    /// (e.g. "http/get").
    function-name: string,
    /// Human-readable description from WIT /// docs.
    description: string,
    /// The function's parameters.
    params: list<tool-param>,
    /// Return type name (e.g. "string", "list<u8>").
    return-type: string,
  }
}

/// The stable entrypoint interface.
interface agent {
  /// Converse with the agent.
  /// The agent manages its own conversation history,
  /// memory, and state internally via the filesystem.
  /// Returns the assistant's response.
  converse: func(input: string) -> string;
}

/// The core orchestration interface.
/// Swappable — users can provide their own core.
interface core {
  /// Run the agent loop for the given input.
  /// Reads/writes conversation history and state
  /// from the filesystem. Returns the assistant's
  /// final response.
  converse: func(input: string) -> string;
}

/// Tool manager interface.
/// Handles discovery, reflection, and dispatch of
/// tool components in the environment.
interface toolkit {
  use types.{tool-info};

  /// List all available tools with descriptions.
  list-tools: func() -> list<tool-info>;

  /// Call a tool function. Returns the result as a string.
  call-tool: func(
    component-name: string,
    function-name: string,
    args-json: string,
  ) -> string;

  /// Format all available tools as a text block
  /// suitable for inclusion in an LLM system prompt.
  format-tools-for-prompt: func() -> string;
}

/// The agent's soul — its personality, values, and
/// evolving self-knowledge. Read and written by the agent.
interface soul {
  /// Read the soul content. Returns empty string if
  /// no soul file exists yet.
  get: func() -> string;

  /// Write the soul content, replacing the existing soul.
  set: func(content: string);
}

/// Persistent memory store. Each memory is a named
/// markdown document the agent can create, read, update,
/// and delete.
interface memory {
  /// List all memory names (without .md extension).
  list-all: func() -> list<string>;

  /// Read a memory by name. Returns empty string if
  /// it doesn't exist.
  get: func(name: string) -> string;

  /// Write a memory. Creates or overwrites.
  set: func(name: string, content: string);

  /// Delete a memory. No-op if it doesn't exist.
  remove: func(name: string);
}

/// Skill documents the agent can consult. Similar to
/// memory but for reference knowledge and learned
/// procedures. Users can ask the agent to learn new
/// skills on-demand.
interface skills {
  /// List all skill names (without .md extension).
  list-all: func() -> list<string>;

  /// Read a skill by name. Returns empty string if
  /// it doesn't exist.
  get: func(name: string) -> string;

  /// Write a skill. Creates or overwrites.
  set: func(name: string, content: string);

  /// Delete a skill. No-op if it doesn't exist.
  remove: func(name: string);
}

world asterbot {
  export types;
}
